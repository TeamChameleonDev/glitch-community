import React from 'react';
import PropTypes from 'prop-types';
import Image from 'Components/images/image';
import classNames from 'classnames/bind';
import { CDN_URL } from 'Utils/constants';

import styles from './bookmark-button.styl';

const cx = classNames.bind(styles);

const CHECKMARK = `${CDN_URL}/ee609ed3-ee18-495d-825a-06fc588a4d4c%2Fcheck-bookmark.svg?v=1564432004008`;
const EMPTY_BOOKMARK = `${CDN_URL}/e73ca55f-dcdd-42a6-a2db-8975a2a8180b%2Fatms-btn-empty.svg?v=1564517818850`;
const FILLED_BOOKMARK = `${CDN_URL}/e73ca55f-dcdd-42a6-a2db-8975a2a8180b%2Fatms-filled.svg?v=1564517819769`;

const Halo = ({ isAnimating }) => (
  <svg
    className={`${styles.halo} ${isAnimating ? styles.haloAnimated : ''}`}
    width="54px"
    height="29px"
    viewBox="0 0 54 29"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    role="presentation"
  >
    <g stroke="none" strokeWidth="0" fill="none" fillRule="evenodd">
      <g transform="translate(-57.000000, -14.000000)">
        <g transform="translate(57.000000, 14.000000)">
          <path
            d="M45.6415248,26.8428627 C45.6415248,26.8031127 45.6415248,26.7621581 45.6403203,26.7212036 C45.6282748,25.9502945 46.216093,25.302249 46.9857975,25.2408172 L51.3197521,24.8951127 C52.2641157,24.8204308 53.0747748,25.5600218 53.092843,26.5067945 C53.0940475,26.6296581 53.0964907,26.7525218 53.0964907,26.8765899 C53.1024794,27.8233627 52.3098884,28.5822263 51.3643203,28.5292263 L47.0219339,28.2895218 C46.2522294,28.2473627 45.6487521,27.6149763 45.6415248,26.8428627"
            className={styles.halo5}
            fill="#7460E1"
          />
          <path
            d="M39.0570438,10.9465192 C39.0570438,10.9067692 39.0570438,10.8658147 39.0558392,10.8248601 C39.0437938,10.053951 39.6316119,9.40590556 40.4013165,9.34447375 L44.735271,8.9987692 C45.6796347,8.92408738 46.4902938,9.66367829 46.5083619,10.610451 C46.5095665,10.7333147 46.5120097,10.8561783 46.5120097,10.9802465 C46.5179983,11.9270192 45.7254074,12.6858828 44.7798392,12.6328828 L40.4374528,12.3931783 C39.6677483,12.3510192 39.064271,11.7186328 39.0570438,10.9465192"
            className={styles.halo4}
            fill="#C454FF"
            transform="translate(42.783834, 10.814536) rotate(-45.000000) translate(-42.783834, -10.814536) "
          />
          <path
            d="M23.1607003,4.36203815 C23.1607003,4.32228815 23.1607003,4.2813336 23.1594958,4.24037906 C23.1474503,3.46946997 23.7352685,2.82142451 24.504973,2.75999269 L28.8389276,2.41428815 C29.7832912,2.33960633 30.5939503,3.07919724 30.6120185,4.02596997 C30.613223,4.1488336 30.6156662,4.27169724 30.6156662,4.39576542 C30.6216548,5.34253815 29.8290639,6.10140178 28.8834958,6.04840178 L24.5411094,5.80869724 C23.7714048,5.76653815 23.1679276,5.13415178 23.1607003,4.36203815"
            className={styles.halo3}
            fill="#83FFCD"
            transform="translate(26.887490, 4.230055) rotate(-90.000000) translate(-26.887490, -4.230055) "
          />
          <path
            d="M7.26435683,10.9465192 C7.26435683,10.9067692 7.26435683,10.8658147 7.26315229,10.8248601 C7.25110683,10.053951 7.83892502,9.40590556 8.60862956,9.34447375 L12.9425841,8.9987692 C13.8869477,8.92408738 14.6976068,9.66367829 14.715675,10.610451 C14.7168796,10.7333147 14.7193228,10.8561783 14.7193228,10.9802465 C14.7253114,11.9270192 13.9327205,12.6858828 12.9871523,12.6328828 L8.64476593,12.3931783 C7.87506138,12.3510192 7.27158411,11.7186328 7.26435683,10.9465192"
            className={styles.halo2}
            fill="#FFE100"
            transform="translate(10.991147, 10.814536) rotate(-135.000000) translate(-10.991147, -10.814536) "
          />
          <path
            d="M0.679875781,26.8428627 C0.679875781,26.8031127 0.679875781,26.7621581 0.678671235,26.7212036 C0.666625781,25.9502945 1.25444396,25.302249 2.02414851,25.2408172 L6.35810305,24.8951127 C7.30246669,24.8204308 8.11312578,25.5600218 8.13119396,26.5067945 C8.13239851,26.6296581 8.1348417,26.7525218 8.1348417,26.8765899 C8.14083033,27.8233627 7.34823942,28.5822263 6.40267124,28.5292263 L2.06028487,28.2895218 C1.29058033,28.2473627 0.687103054,27.6149763 0.679875781,26.8428627"
            className={styles.halo1}
            fill="#DC352C"
            transform="translate(4.406666, 26.710879) rotate(-180.000000) translate(-4.406666, -26.710879) "
          />
        </g>
      </g>
    </g>
  </svg>
);

Halo.propTypes = {
  isAnimating: PropTypes.bool.isRequired,
};

const EmptyBookmark = () => (
  <svg className={`${styles.emptyBookmark}`} width="26px" height="34px" viewBox="0 0 26 34" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <g id="atms-btn-empty" transform="translate(1.000000, 1.000000)" fill-rule="nonzero">
      <path
        className={`${styles.bookmarkOutline}`}
        d="M21.5403125,0.96 C21.8218243,0.96 22.0910925,1.01591484 22.348125,1.1277462 C22.7520333,1.28928038 23.0733191,1.54400355 23.3119922,1.89192333 C23.5506653,2.23984311 23.67,2.62503424 23.67,3.04750826 L23.67,28.9524917 C23.67,29.3749658 23.5506653,29.7601569 23.3119922,30.1080767 C23.0733191,30.4559965 22.7520333,30.7107196 22.348125,30.8722538 C22.1155718,30.9716595 21.8463036,31.0213615 21.5403125,31.0213615 C20.9528096,31.0213615 20.4448719,30.8225532 20.0164844,30.4249306 L11.92,22.5222208 L3.82351563,30.4249306 C3.38288842,30.8349789 2.87495079,31.04 2.2996875,31.04 C2.01817568,31.04 1.74890754,30.9840852 1.491875,30.8722538 C1.08796673,30.7107196 0.766680881,30.4559965 0.528007813,30.1080767 C0.289334744,29.7601569 0.17,29.3749658 0.17,28.9524917 L0.17,3.04750826 C0.17,2.62503424 0.289334744,2.23984311 0.528007813,1.89192333 C0.766680881,1.54400355 1.08796673,1.28928038 1.491875,1.1277462 C1.74890754,1.01591484 2.01817568,0.96 2.2996875,0.96 L21.5403125,0.96 Z"
        stroke="#C3C3C3"
        stroke-width="2"
        fill="#FFFFFF"
      />
      <g id="Group-Copy" transform="translate(6.520000, 6.756020)" fill="#C3C3C3">
        <path
          d="M6.71389301,4.03725727 L8.85939217,4.03725727 C9.40526918,4.03725727 9.84778993,4.47977802 9.84778993,5.02565503 C9.84778993,5.57153204 9.40526918,6.01405279 8.85939217,6.01405279 L6.71389301,6.01405279 L6.71389301,8.15955193 C6.71389301,8.885195 6.12564307,9.47344494 5.4,9.47344494 C4.67435693,9.47344494 4.08610699,8.885195 4.08610699,8.15955193 L4.08610699,6.01405279 L1.94060787,6.01405279 C1.39473119,6.01405279 0.952210074,5.57153235 0.952210074,5.02565503 C0.952210074,4.47977771 1.39473119,4.03725727 1.94060787,4.03725727 L4.08610699,4.03725727 L4.08610699,1.89175813 C4.08610699,1.16611506 4.67435693,0.577865119 5.4,0.577865119 C6.12564307,0.577865119 6.71389301,1.16611506 6.71389301,1.89175813 L6.71389301,4.03725727 Z M4.82424913,4.1244089 L5.97575087,4.1244089 L5.97575087,5.92690116 L4.82424913,5.92690116 L4.82424913,4.1244089 Z"
          id="Combined-Shape"
        />
      </g>
    </g>
  </svg>
);

const FilledBookmark = () => (
  <svg className={`${styles.filledBookmark}`} width="26px" height="33px" viewBox="0 0 26 33" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <path
      className={`${styles.bookmarkOutline}`}
      d="M22.6767548,1.28000021 C22.9623034,1.28000021 23.2354327,1.33697005 23.496151,1.45091143 C23.9058511,1.61549343 24.2317441,1.87502269 24.4738397,2.229507 C24.7159352,2.58399131 24.8369812,2.97645019 24.8369812,3.40689542 L24.8369812,29.8006522 C24.8369812,30.2310974 24.7159352,30.6235563 24.4738397,30.9780406 C24.2317441,31.3325249 23.9058511,31.5920542 23.496151,31.7566362 C23.260263,31.8579174 22.9871337,31.9085572 22.6767548,31.9085572 C22.0808272,31.9085572 21.565606,31.7059978 21.1310755,31.3008729 L12.9184906,23.2490553 L4.70590566,31.3008729 C4.25896003,31.718658 3.74373876,31.9275474 3.16022641,31.9275474 C2.87467781,31.9275474 2.60154847,31.8705775 2.34083018,31.7566362 C1.93113002,31.5920542 1.60523706,31.3325249 1.36314151,30.9780406 C1.12104596,30.6235563 1,30.2310974 1,29.8006522 L1,3.40689542 C1,2.97645019 1.12104596,2.58399131 1.36314151,2.229507 C1.60523706,1.87502269 1.93113002,1.61549343 2.34083018,1.45091143 C2.60154847,1.33697005 2.87467781,1.28000021 3.16022641,1.28000021 L22.6767548,1.28000021 Z"
      stroke="#222222"
      stroke-width="2"
      fill="#05D458"
      fill-rule="nonzero"
    />
  </svg>
);

const BookmarkButton = ({ action, initialIsBookmarked }) => {
  const [state, setState] = React.useState({ isBookmarked: initialIsBookmarked, isAnimating: false });
  const onClick = () => {
    if (!state.isBookmarked) {
      setState({ isAnimating: true, isBookmarked: true });
    } else {
      setState({ isAnimating: false, isBookmarked: false });
    }
    if (action) action();
  };
  const checkClassName = cx({
    check: true,
    checkAnimated: state.isAnimating,
    hidden: !state.isBookmarked,
  });

  return (
    <button
      className={styles.bookmarkButton}
      onClick={onClick}
      aria-pressed={state.isBookmarked ? 'true' : 'false'}
      aria-label="Add project to My Stuff"
    >
      <Halo isAnimating={state.isAnimating} />
      {state.isBookmarked ? <FilledBookmark /> : <EmptyBookmark />}
      {/* <Image src={state.isBookmarked ? FILLED_BOOKMARK : EMPTY_BOOKMARK} alt="" /> */}
      <Image className={checkClassName} src={CHECKMARK} alt="" width="10px" height="10px" />
    </button>
  );
};

BookmarkButton.propTypes = {
  action: PropTypes.func,
  initialIsBookmarked: PropTypes.bool,
};

BookmarkButton.defaultProps = {
  action: undefined,
  initialIsBookmarked: false,
};

export default BookmarkButton;
