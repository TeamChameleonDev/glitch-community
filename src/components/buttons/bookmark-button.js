import React from 'react';
import PropTypes from 'prop-types';
import Image from 'Components/images/image';
import classNames from 'classnames/bind';
import { CDN_URL } from 'Utils/constants';

import styles from './bookmark-button.styl';

const cx = classNames.bind(styles);

const CHECKMARK = `${CDN_URL}/ee609ed3-ee18-495d-825a-06fc588a4d4c%2Fcheck-bookmark.svg?v=1564432004008`;
const EMPTY_BOOKMARK = `${CDN_URL}/e73ca55f-dcdd-42a6-a2db-8975a2a8180b%2Fatms-btn-empty.svg?v=1564517818850`;
const FILLED_BOOKMARK = `${CDN_URL}/e73ca55f-dcdd-42a6-a2db-8975a2a8180b%2Fatms-filled.svg?v=1564517819769`;

const Halo = ({ isAnimating }) => (
  <svg
    className={`${styles.halo} ${isAnimating ? styles.haloAnimated : ''}`}
    width="54px"
    height="29px"
    viewBox="0 0 54 29"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    role="presentation"
  >
    <g stroke="none" strokeWidth="0" fill="none" fillRule="evenodd">
      <g transform="translate(-57.000000, -14.000000)">
        <g transform="translate(57.000000, 14.000000)">
          <path
            d="M45.6415248,26.8428627 C45.6415248,26.8031127 45.6415248,26.7621581 45.6403203,26.7212036 C45.6282748,25.9502945 46.216093,25.302249 46.9857975,25.2408172 L51.3197521,24.8951127 C52.2641157,24.8204308 53.0747748,25.5600218 53.092843,26.5067945 C53.0940475,26.6296581 53.0964907,26.7525218 53.0964907,26.8765899 C53.1024794,27.8233627 52.3098884,28.5822263 51.3643203,28.5292263 L47.0219339,28.2895218 C46.2522294,28.2473627 45.6487521,27.6149763 45.6415248,26.8428627"
            className={styles.halo5}
            fill="#7460E1"
          />
          <path
            d="M39.0570438,10.9465192 C39.0570438,10.9067692 39.0570438,10.8658147 39.0558392,10.8248601 C39.0437938,10.053951 39.6316119,9.40590556 40.4013165,9.34447375 L44.735271,8.9987692 C45.6796347,8.92408738 46.4902938,9.66367829 46.5083619,10.610451 C46.5095665,10.7333147 46.5120097,10.8561783 46.5120097,10.9802465 C46.5179983,11.9270192 45.7254074,12.6858828 44.7798392,12.6328828 L40.4374528,12.3931783 C39.6677483,12.3510192 39.064271,11.7186328 39.0570438,10.9465192"
            className={styles.halo4}
            fill="#C454FF"
            transform="translate(42.783834, 10.814536) rotate(-45.000000) translate(-42.783834, -10.814536) "
          />
          <path
            d="M23.1607003,4.36203815 C23.1607003,4.32228815 23.1607003,4.2813336 23.1594958,4.24037906 C23.1474503,3.46946997 23.7352685,2.82142451 24.504973,2.75999269 L28.8389276,2.41428815 C29.7832912,2.33960633 30.5939503,3.07919724 30.6120185,4.02596997 C30.613223,4.1488336 30.6156662,4.27169724 30.6156662,4.39576542 C30.6216548,5.34253815 29.8290639,6.10140178 28.8834958,6.04840178 L24.5411094,5.80869724 C23.7714048,5.76653815 23.1679276,5.13415178 23.1607003,4.36203815"
            className={styles.halo3}
            fill="#83FFCD"
            transform="translate(26.887490, 4.230055) rotate(-90.000000) translate(-26.887490, -4.230055) "
          />
          <path
            d="M7.26435683,10.9465192 C7.26435683,10.9067692 7.26435683,10.8658147 7.26315229,10.8248601 C7.25110683,10.053951 7.83892502,9.40590556 8.60862956,9.34447375 L12.9425841,8.9987692 C13.8869477,8.92408738 14.6976068,9.66367829 14.715675,10.610451 C14.7168796,10.7333147 14.7193228,10.8561783 14.7193228,10.9802465 C14.7253114,11.9270192 13.9327205,12.6858828 12.9871523,12.6328828 L8.64476593,12.3931783 C7.87506138,12.3510192 7.27158411,11.7186328 7.26435683,10.9465192"
            className={styles.halo2}
            fill="#FFE100"
            transform="translate(10.991147, 10.814536) rotate(-135.000000) translate(-10.991147, -10.814536) "
          />
          <path
            d="M0.679875781,26.8428627 C0.679875781,26.8031127 0.679875781,26.7621581 0.678671235,26.7212036 C0.666625781,25.9502945 1.25444396,25.302249 2.02414851,25.2408172 L6.35810305,24.8951127 C7.30246669,24.8204308 8.11312578,25.5600218 8.13119396,26.5067945 C8.13239851,26.6296581 8.1348417,26.7525218 8.1348417,26.8765899 C8.14083033,27.8233627 7.34823942,28.5822263 6.40267124,28.5292263 L2.06028487,28.2895218 C1.29058033,28.2473627 0.687103054,27.6149763 0.679875781,26.8428627"
            className={styles.halo1}
            fill="#DC352C"
            transform="translate(4.406666, 26.710879) rotate(-180.000000) translate(-4.406666, -26.710879) "
          />
        </g>
      </g>
    </g>
  </svg>
);

Halo.propTypes = {
  isAnimating: PropTypes.bool.isRequired,
};

const FilledBookmark = () => (
  <svg 
    width="32px" 
    height="39px" 
    viewBox="0 0 32 39" 
    version="1.1" 
    xmlns="http://www.w3.org/2000/svg">
      <path d="M23.6767548,2 C23.9623034,2 24.2354327,2.05696984 24.496151,2.17091122 C24.9058511,2.33549322 25.2317441,2.59502248 25.4738397,2.94950679 C25.7159352,3.3039911 25.8369812,3.69644998 25.8369812,4.12689521 L25.8369812,30.520652 C25.8369812,30.9510972 25.7159352,31.3435561 25.4738397,31.6980404 C25.2317441,32.0525247 24.9058511,32.312054 24.496151,32.476636 C24.260263,32.5779172 23.9871337,32.628557 23.6767548,32.628557 C23.0808272,32.628557 22.565606,32.4259976 22.1310755,32.0208727 L13.9184906,23.9690551 L5.70590566,32.0208727 C5.25896003,32.4386578 4.74373876,32.6475472 4.16022641,32.6475472 C3.87467781,32.6475472 3.60154847,32.5905773 3.34083018,32.476636 C2.93113002,32.312054 2.60523706,32.0525247 2.36314151,31.6980404 C2.12104596,31.3435561 2,30.9510972 2,30.520652 L2,4.12689521 C2,3.69644998 2.12104596,3.3039911 2.36314151,2.94950679 C2.60523706,2.59502248 2.93113002,2.33549322 3.34083018,2.17091122 C3.60154847,2.05696984 3.87467781,2 4.16022641,2 L23.6767548,2 Z" id="atms-filled-copy" stroke="#222222" stroke-width="2" fill="#05D458"></path>
      <path className={`${styles.highlight}`} d="M27.8369812,4.12689521 L27.8369812,30.520652 C27.8369812,31.3635763 27.5994484,32.1319071 27.1254226,32.8259915 C26.6625495,33.5037455 26.0437244,34.0058666 25.2622741,34.3241575 C24.8045649,34.5169823 24.278348,34.628557 23.6767548,34.628557 C22.5452714,34.628557 21.5687972,34.2398226 20.7465264,33.4643069 L13.9184906,26.7699348 L7.09114604,33.4636291 C6.24484059,34.2630068 5.26400236,34.6475472 4.16022641,34.6475472 C3.60578019,34.6475472 3.07509269,34.5386452 2.56802473,34.3214296 C1.78972801,34.0030009 1.17311138,33.5018124 0.711558447,32.8259914 C0.237532711,32.1319072 -1.77635684e-15,31.3635763 -1.77635684e-15,30.520652 L-1.77635684e-15,4.12689521 C-1.77635684e-15,3.28397081 0.237532705,2.51563999 0.711558432,1.82155584 C1.17311133,1.14573483 1.78972787,0.644546405 2.5680245,0.326117681 C3.07509253,0.108901981 3.60578011,5.68434189e-14 4.16022641,5.68434189e-14 L23.6767548,5.68434189e-14 C24.2312011,5.68434189e-14 24.7618886,0.108901979 25.2689567,0.326117696 C26.0472531,0.64454638 26.6638697,1.14573475 27.1254228,1.821556 C27.5994484,2.5156401 27.8369812,3.28397088 27.8369812,4.12689521 Z" stroke="#A2D7FF" stroke-width="3"></path>
  </svg>
);

const EmptyBookmark = () => (
  <svg width="32px" height="39px" viewBox="0 0 32 39" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <g id="atms-btn-empty" transform="translate(2.000000, 2.000000)" fill-rule="nonzero">
            <path className={`${styles.highlight}`} d="M27.8369812,4.40689542 L27.8369812,30.8006522 C27.8369812,31.6435765 27.5994484,32.4119073 27.1254226,33.1059917 C26.6625495,33.7837457 26.0437244,34.2858668 25.2622741,34.6041577 C24.8045649,34.7969825 24.278348,34.9085572 23.6767548,34.9085572 C22.5452714,34.9085572 21.5687972,34.5198229 20.7465264,33.7443071 L13.9184906,27.049935 L7.09114604,33.7436293 C6.24484059,34.543007 5.26400236,34.9275474 4.16022641,34.9275474 C3.60578019,34.9275474 3.07509269,34.8186454 2.56802473,34.6014298 C1.78972801,34.2830011 1.17311138,33.7818126 0.711558447,33.1059916 C0.237532711,32.4119074 0,31.6435766 0,30.8006522 L0,4.40689542 C0,3.56397102 0.237532705,2.7956402 0.711558432,2.10155605 C1.17311133,1.42573504 1.78972787,0.924546613 2.5680245,0.606117889 C3.07509253,0.388902189 3.60578011,0.280000208 4.16022641,0.280000208 L23.6767548,0.280000208 C24.2312011,0.280000208 24.7618886,0.388902187 25.2689567,0.606117904 C26.0472531,0.924546588 26.6638697,1.42573495 27.1254228,2.10155621 C27.5994484,2.79564031 27.8369812,3.56397109 27.8369812,4.40689542 Z" stroke="#A2D7FF" stroke-width="3"></path>
            <path d="M23.5388031,2.1037738 C23.8203149,2.1037738 24.0895831,2.16139881 24.3466156,2.27665054 C24.7505239,2.44312526 25.0718097,2.70563916 25.3104828,3.06420011 C25.5491559,3.42276105 25.6684906,3.81973329 25.6684906,4.25512873 L25.6684906,30.9524188 C25.6684906,31.3878144 25.5491559,31.7847866 25.3104828,32.1433475 C25.0718097,32.5019085 24.7505239,32.7644223 24.3466156,32.9308971 C24.1140624,33.0333431 23.8447942,33.0845652 23.5388031,33.0845652 C22.9513002,33.0845652 22.4433625,32.8796764 22.014975,32.4698924 L13.9184906,24.3254774 L5.82200621,32.4698924 C5.381379,32.8924821 4.87344137,33.1037738 4.29817808,33.1037738 C4.01666626,33.1037738 3.74739812,33.0461488 3.49036558,32.9308971 C3.08645731,32.7644223 2.76517146,32.5019085 2.5264984,32.1433475 C2.28782533,31.7847866 2.16849058,31.3878144 2.16849058,30.9524188 L2.16849058,4.25512873 C2.16849058,3.81973329 2.28782533,3.42276105 2.5264984,3.06420011 C2.76517146,2.70563916 3.08645731,2.44312526 3.49036558,2.27665054 C3.74739812,2.16139881 4.01666626,2.1037738 4.29817808,2.1037738 L23.5388031,2.1037738 Z" id="bookmark" stroke="#C3C3C3" stroke-width="2" fill="#FFFFFF"></path>
            <g id="Group-Copy" transform="translate(8.520000, 8.756020)" fill="#C3C3C3">
                <path d="M6.71389301,4.03725727 L8.85939217,4.03725727 C9.40526918,4.03725727 9.84778993,4.47977802 9.84778993,5.02565503 C9.84778993,5.57153204 9.40526918,6.01405279 8.85939217,6.01405279 L6.71389301,6.01405279 L6.71389301,8.15955193 C6.71389301,8.885195 6.12564307,9.47344494 5.4,9.47344494 C4.67435693,9.47344494 4.08610699,8.885195 4.08610699,8.15955193 L4.08610699,6.01405279 L1.94060787,6.01405279 C1.39473119,6.01405279 0.952210074,5.57153235 0.952210074,5.02565503 C0.952210074,4.47977771 1.39473119,4.03725727 1.94060787,4.03725727 L4.08610699,4.03725727 L4.08610699,1.89175813 C4.08610699,1.16611506 4.67435693,0.577865119 5.4,0.577865119 C6.12564307,0.577865119 6.71389301,1.16611506 6.71389301,1.89175813 L6.71389301,4.03725727 Z M4.82424913,4.1244089 L5.97575087,4.1244089 L5.97575087,5.92690116 L4.82424913,5.92690116 L4.82424913,4.1244089 Z" id="Combined-Shape"></path>
            </g>
        </g>
  </svg>
);

const BookmarkButton = ({ action, initialIsBookmarked }) => {
  const [state, setState] = React.useState({ isBookmarked: initialIsBookmarked, isAnimating: false });
  const onClick = () => {
    if (!state.isBookmarked) {
      setState({ isAnimating: true, isBookmarked: true });
    } else {
      setState({ isAnimating: false, isBookmarked: false });
    }
    if (action) action();
  };
  const checkClassName = cx({
    check: true,
    checkAnimated: state.isAnimating,
    hidden: !state.isBookmarked,
  });

  return (
    <button
      className={styles.bookmarkButton}
      onClick={onClick}
      aria-pressed={state.isBookmarked ? 'true' : 'false'}
      aria-label="Add project to My Stuff"
    >
      <Halo isAnimating={state.isAnimating} />
      <div className={styles.focusRing}/>
      {state.isBookmarked ? <FilledBookmark /> : <EmptyBookmark />}
      {/* <Image src={state.isBookmarked ? FILLED_BOOKMARK : EMPTY_BOOKMARK} alt="" /> */}
      <Image className={checkClassName} src={CHECKMARK} alt="" width="10px" height="10px" />
    </button>
  );
};

BookmarkButton.propTypes = {
  action: PropTypes.func,
  initialIsBookmarked: PropTypes.bool,
};

BookmarkButton.defaultProps = {
  action: undefined,
  initialIsBookmarked: false,
};

export default BookmarkButton;
